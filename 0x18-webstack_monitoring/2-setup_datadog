#!/bin/bash

# Define your Datadog API and Application Keys
DD_API_KEY="9ff7af27243dc94b2f5b1e0e4d0584e3"
DD_APP_KEY="187e1fab43ad1b02d26e27288760d7e15567c26e"

# Fetch all dashboards
response=$(curl -s -X GET \
-H "DD-API-KEY: $DD_API_KEY" \
-H "DD-APPLICATION-KEY: $DD_APP_KEY" \
"https://api.datadoghq.com/api/v1/dashboard")

# Parse the JSON response to find the dashboard named "william" and extract its id
dashboard_id=$(echo $response | jq -r '.dashboards[] | select(.title == "william") | .id')

# Check if the dashboard_id was found
if [ -z "$dashboard_id" ]; then
  echo "Dashboard named 'william' not found"
  exit 1
fi

# Create the answer file with the dashboard_id
echo $dashboard_id > 2-setup_datadog

echo "Dashboard ID has been written to 2-setup_datadog"

